
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<p><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-beta1/katex.min.css" integrity="sha384-VEnyslhHLHiYPca9KFkBB3CMeslnM9CzwjxsEbZTeA21JBm7tdLwKoZmCt3cZTYD" crossorigin="anonymous"> 
</p>
<div class="container">
  <title>CS202: Lab 1: C review, gdb, software skills</title>
  <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <style type=text/css>
  @import url("https://use.typekit.net/jlb5olz.css");
  
  /* heavily borrowed from Harvard's cs61, which calls it cs161.css */
  
  ol > li > ol {
  	list-style-type: lower-alpha;
  }
  ol.upper-alpha {
  	list-style-type: upper-alpha;
  }
  p + ol, p + ul {
  	margin-bottom: 1rem;
  }
  p:last-child {
  	margin-bottom: 0.5rem;
  }
  
  /* cs202 additions */
  .required, .challenge, .question {
    padding: .5em .5em .5em .5em;
    display: block;
    margin-left: auto;
    margin-right: auto;
    background: #f0f0ff;
  }
  
  .highlight {
      border-left: 0.25rem solid rgba(255, 255, 0, 0.5);
      background: #fffff0;
      padding-left: 0.25rem;
      padding-top: 0.25rem;
      padding-bottom: 0.25rem;
      padding-right: 1rem;
  }
  
  .honors {
    padding: .5em .5em .5em .5em;
    display: block;
    margin-left: auto;
    margin-right: auto;
    background: #fffff0;
  }
  
  
  .callout {
      border-left: 0.25rem solid #5bc0de;
      background: #5bc0de;
      padding-left: 0.25rem;
      padding-top: 0.25rem;
      padding-bottom: 0.25rem;
      padding-right: 1rem;
  }
  
  div.required .header {
      font-weight: bold;
  }
  div.honors .header {
      font-weight: bold;
  }
  
  div.callout .header {
      font-weight: bold;
  }
  
  
  div.challenge .header {
      font-style: italic;
  }
  
  
  div.challenge {
      background-color: #ffe0e0;
  }
  
  
  
  div.highlight .header {
      font-weight: bold;
  }
  
  pre {
      background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4
  }
  
  #topnavbar ul {
   width: 100%;
   float: left;
  
   margin: 0;
   padding: 0;
  
   text-align: center;
   white-space: nowrap;
   color: #000;
   font-family: Arial, Helvetica, sans-serif;
   background-color: white;
   border-top: solid 2px maroon;
   border-bottom: solid 2px maroon;
   clear: right;
   margin-top: .5em;
   margin-bottom: .5em;
  }
  
  #topnavbar ul li {
   display: inline;
   padding-left: 0;
   padding-right: 0;
  }
  
  #topnavbar ul li a {
   padding: 3px 10px;
   text-decoration: none;
   color: #000;
   background-color: white;
   float: left;
   border-right: 1px solid black;
  }
  
  #topnavbar ul li a:hover {
   background-color: maroon;
   color: white;
  }
  
  #topnavbar div { 
   clear: both;
  }
  
  div#news {
    width: 30%;
    float: right;
    margin-left: 2em;
    padding-left: 1em;
    background-color: #fffff0;
    margin-bottom: 0.5em;
    border-left: 0.25rem solid rgba(255, 255, 0, 0.5);
  /*  border: 1px solid maroon;*/
  }
  
  dl.idealist dt { 
    font-weight: bold;
  }
  
  dl.idealist dt { 
    margin-top: 0.5em;
  }
  
  
  dl.newslist { 
   margin: 0;
   padding: 0;
  }
  
  dl.newslist dt { 
   padding-left: 0;
   color: #000055;
   font-weight: bold;
   margin-bottom: 0.2em;
  }
  
  dl.newslist dd {
    padding-bottom: 1em;
    margin-bottom: 0;
    margin-left: 1em;
    padding-left: 0;
    margin-right: 1em;
  }
  
  div#news p { 
  margin-top: 0; 
  padding-top: 0;
  }
  
  #announcements p { 
    color: maroon;
  }
  
  #announcements h1 { 
    color: #ffffff;
    text-align: center;
    font-size: 110%;
    text-decoration: underline;
  }
  
  /* The alternating announcement colors */
  #announcements p.one { color: #ff0000; }
  #announcements p.two { color: #00ff00; }
  #announcements p.three { color: #3333ff; }
  
  .announce_date { font-weight: bold; }
  table.people {
    margin-left: 10px;
    padding: 2px;
    border-collapse: collapse;
    border: none;
  }
  
  table.people th { 
    font-weight: bold;
    text-align: left;
    border: 0;
  /*  border-bottom: solid 2px; */
  }
  
  table.people td { 
    padding-right: 1em;
  /*
    border: none;
    border-bottom: 1px solid #888;
    padding-right: 1em;
    padding-left: 1em;
  */
  }
  
  table.books {
    margin-left: 2%;
  /*  margin-bottom: 8px; */
  }
  
  table.books tr,td {
    vertical-align: top;
  }
  
  table.assignments { 
  /*  width: 98%; */
    margin-left: 1%;
    margin-right: 1%;
    border-collapse: collapse;
  }
  
  table.assignments th { 
  /*  background: #E0FFFF;*/
    color: black;
    border: none;
    text-align: left;
    width: 29%;
  }
  
  table.assignments tr,td { 
  /*  padding: 50px;
    border-width: 50px;
    border-style: solid;
    border-color: black;
    border-spacing: 0px;*/
    border: none;
  }
  
  table.schedule {
    width: 98%;
    margin-left: 1%;
    margin-right: 1%;
    border-collapse:  collapse;
  }
  
  table.schedule th { 
  /*  background: maroon;*/
    color: black;
    border-width: 0px;
    text-align: left;
  }
  
  table.Schedule tr { 
    padding: 3px;  
    border-width: 1px; 
    border-spacing: 0px; 
    border-style: solid;  
    border-color: black;
  }
  
  table.Schedule th,td { 
    padding: 5px;  
    border-width: 1px; 
    border-spacing: 0px; 
    border: none;  
    border-color: black;
  }
  /* Presentation:  No underlines on links in schedule unless you're
   * moving the mouse over it. */
  
  table.schedule tr.lecture { background: white; border-bottom: 1px solid #736F6E; }
  table.schedule tr.alt { background: #E0FFFF; }
  /*table.schedule tr.lecture.alt { background: white; }*/
  /*table.schedule tr.noclass { background: #d3d3d3; }
  table.schedule tr.makeupclass { background: #FAAFBE; }*/
  table.schedule tr.noclass { color: #736F6E; }
  table.schedule tr.makeupclass { color: #FF0000; border-bottom: 1px solid #736F6E;}
  table.schedule td.readings { color: black; }
  table.schedule td.altreadings { color: black; }
  table.schedule tr.due { color: #FF0000; }
  table.schedule td.due { color: #FF0000; }
  table.schedule tr.exam    { color: #FF0000; background: #ccf; }
  table.schedule tr.recitation { background: #ccf; }
  table.schedule tr.recitation.alt { background: #ccf; }
  table.schedule tr.lechead { font-weight: bold; text-align: left; height:20px}
  
  
  
  /* end cs202 additions */
  
  blockquote {
  	margin-left: 2rem;
  	padding-left: 1rem;
  }
  blockquote > h3:first-child {
  	margin-top: 0.5rem;
  }
  blockquote, blockquote.solution.note {
  	border-left: 0.25rem solid rgba(0, 0, 80, 0.25);
  }
  .solution.shown, .solution-collapsed.shown {
  	animation: slide-down .3s ease-out;
  }
  .solution, blockquote.highlight {
  	border-left: 0.25rem solid rgba(255, 255, 0, 0.5);
  	background: #fffff0;
  	padding-top: 0.25rem;
  	padding-bottom: 0.25rem;
  	padding-right: 1rem;
  }
  .solution-collapsed, blockquote.note {
  	background: #f0f0ff;
  	padding-top: 0.25rem;
  	padding-bottom: 0.25rem;
  	padding-right: 1rem;
  }
  .solution-collapsed {
  	display: table;
  	border-left: 0rem none;
  	margin-left: 0rem;
  	font-size: smaller;
  }
  .larger {
  	font-size: larger;
  }
  a.js-solution.hide {
  	font-size: smaller;
  }
  a.js-solution.hide.all {
  	font-size: inherit;
  }
  .githubref {
  	text-align: right;
  	margin-top: -0.5rem;
  	font-style: italic;
  	font-size: 0.75rem;
  }
  .float-left {
  	float: left;
  }
  .float-right {
  	float: right;
  }
  @keyframes slide-down {
  	0% { opacity: 0; }
  	100% { opacity: 1; }
  }
  .post {
  	margin-bottom: 3rem;
  }
  .post img {
  	max-width: 100%;
  }
  .tall > img {
  	max-height: 50vh;
  }
  h1, h2, h3, h4 {
  	font-family: "brix-slab", sans-serif;
  }
  h1 {
  	font-weight: 900;
  }
  h2 {
  	margin-top: 3rem;
  	font-weight: 700;
  }
  h2:first-child {
  	margin-top: 0;
  }
  .h3, h3 {
  	font-size: 1.5rem;
  }
  .h4, h4 {
  	font-size: 1.25rem;
  	font-style: italic;
  }
  h3 {
  	margin-top: 1.5rem;
  }
  h3 > code {
  	color: inherit;
  }
  .container th, .container td {
  	padding: 0.15rem 1.5rem 0.15rem 0;
  }
  .container table {
  	margin: 0.85rem 0;
  	border-spacing: 0;
  }
  tr.even > td,
  table.alternate > tbody > tr:nth-child(even) > td {
  	background: #f0f0ff;
  }
  tr.separator > td, tr.separator > th {
  	background: #d8d8f8;
  }
  td > p:first-child, th > p:first-child {
  	margin-top: 0.25rem;
  }
  td > p:last-child, th > p:last-child {
  	margin-bottom: 0.25rem;
  }
  table.padleft > thead > tr > th:first-child,
  table.padleft > tbody > tr > td:first-child,
  table.padleft > tbody > tr > th:first-child {
  	padding-left: 0.35rem;
  }
  th.r {
  	font-weight: normal;
  }
  tr.row-wide-padding > td {
  	padding-left: 3em;
  	padding-right: 3em;
  }
  tr.row-wide-padding > td:first-child {
  	padding-left: 0;
  }
  tr.row-wide-padding > td:last-child {
  	padding-right: 0;
  }
  tr.row-space-above > td {
  	padding-top: 3em;
  }
  div.sp {
  	margin-top: 3em;
  }
  
  blockquote.float-left {
  	margin-left: 0;
  	padding-left: 0;
  	border-left: 0 none;
  	margin-right: 3rem;
  }
  blockquote.float-left.half-width {
  	min-width: 25rem;
  	max-width: 100%;
  }
  
  /* prettier table types */
  table.wikitable > tr > th,
  table.wikitable > tr > td,
  table.wikitable > * > tr > th,
  table.wikitable > * > tr > td {
  	border: 1px solid #a2a9b1;
  	padding: 0.2em 0.4em;
  }
  table.wikitable th {
  	text-align: center;
  	background-color: #eaecf0;
  }
  td.hgray, tr.hgray {
  	background-color: #888888;
  }
  td.hpink, tr.hpink {
  	background: #ff80bb;
  }
  
  table.truthtable > * > tr > th,
  table.truthtable > * > tr > td {
  	border: 2px solid #a2a9b1;
  	padding: 0.6em;
  	text-align: center;
  }
  
  table.nowrap1 > * > tr > th:first-child,
  table.nowrap1 > * > tr > td:first-child {
  	white-space: nowrap;
  }
  table.text-right-1 > * > tr > th:first-child,
  table.text-right-1 > * > tr > td:first-child {
  	text-align: right;
  }
  table.text-right-2 > * > tr > th:nth-child(2),
  table.text-right-2 > * > tr > td:nth-child(2) {
  	text-align: right;
  }
  .text-left {
  	text-align: left;
  }
  .text-center {
  	text-align: center;
  }
  .text-right {
  	text-align: right;
  }
  
  hr.c {
  	clear: both;
  	margin: 0;
  	border: 0 none;
  	height: 0;
  }
  
  .hellobackground {
  	position: fixed;
  	transform: rotate(-15deg);
  	opacity: 0.15;
  	z-index: -1;
  	top: -3rem;
  	left: -2.5rem;
  }
  .float-left.rotate-img-m5 {
  	margin-right: 1.5em;
  }
  .float-right.rotate-img-5 {
  	margin-left: 1.5em;
  }
  img.rotate-img-5, .rotate-img-5 img {
  	transform: rotate(5deg);
  }
  img.rotate-img-m5, .rotate-img-m5 img {
  	transform: rotate(-5deg);
  }
  
  figure > img {
  	max-width: 100%;
  	object-fit: scale-down;
  }
  
  .navbar-has-drafts {
  	background: yellow;
  }
  
  .hidden {
  	display: none;
  }
  hr.prbr {
  	border: 0 none;
  }
  hr.twoem {
  	border: 0 none;
  	margin-top: 2em;
  }
  hr.fourem {
  	border: 0 none;
  	margin-top: 4em;
  }
  hr.eightem {
  	border: 0 none;
  	margin-top: 8em;
  }
  hr.sixteenem {
  	border: 0 none;
  	margin-top: 16em;
  }
  
  @media print {
  html {
  	font-size: 125%;
  }
  h1 {
  	font-size: 2rem;
  }
  h2 {
  	font-size: 1.5rem;
  	margin-top: 2rem;
  }
  .prbr {
  	page-break-before: always;
  	margin-top: 0;
  }
  @page {
  	margin-top: 0.75in;
  	margin-bottom: 0.75in;
  }
  .hellobackground {
  	display: none;
  }
  .print-hide-solutions .solution, .print-hide-solutions .solution-collapsed {
  	display: none;
  }
  a, a:not(.btn) {
  	color: inherit;
  	text-decoration: none;
  }
  }
  
  @media not print {
  .pronly {
  	display: none;
  }
  }
  
  .navbar .gsc-control-cse {
  	padding: 0;
  	padding-top: .5rem;
  	padding-left: 1rem;
  	background: inherit;
  	border: 0 none;
  }
  </style>
</head>
<body>
<nav>
<a href="../index.html">Home</a> |
<a href="../syllabus.html">Schedule</a> |
<a href="../policies.html">Policies and grading</a> |
<a href="../labs.html">Labs</a> |
<a href="../setup.html">Infrastructure</a> |
<a href="../exams.html">Exams</a></li> |
<!--<a href="../tools.html">Tools</a></li>-->
<a href="../reference.html">Reference materials</a> |
<a href="../announcements.html">Announcements</a>
</nav>
<p></p>
<header id="title-block-header">
<h1 class="title">CS202: Lab 1: C review, gdb, software skills</h1>
</header>
<p></p>
<div class="post">
<p>This lab will reinforce your prior experience in the C programming language and give you practice using certain command-line tools. The overall comfort you’ll gain (or reinforce) with the Unix computing environment will be helpful for future labs.</p>
<h2 id="getting-started">Getting started</h2>
<p>You will perform the labs on a virtual <em>devbox</em> (a machine with all of the required development software installed on it), and pull/push code with git and GitHub. It's time for you to set up that infrastructure:</p>
<div class="highlight">
<p><span class="header">Before you go further.</span> Go to the <a href="../setup.html">setup page</a>, and follow the instructions there. Specifically:</p>
<ol type="1">
<li>Get a GitHub account if you don’t have one already</li>
<li>Install the class devbox (on your personal computer or on a user account on the CIMS machines)</li>
<li>Set up your git repository (clone on GitHub, enter the class devbox, setup SSH keys, clone to the devbox, set upstream)</li>
<li>Read through the <a href="../setup.html#git-faq">git FAQs</a></li>
</ol>
<p>Come back here when you’ve done these.</p>
</div>
<div class="highlight">
<p><span class="header">Programming style.</span> In this and subsequent labs, you will be graded for style. We will deduct up to 20% of total lab points for poor style based on our subjective evaluation. Please read this <a href="https://cs61.seas.harvard.edu/site/2019/Style/">style guide</a>.</p>
</div>
<h2 id="section-1-c-review">Section 1: C review</h2>
<p>All of the projects in this class will be done in C or C++, for two main reasons. First, some of the things that we want to implement require direct manipulation of hardware state and memory, which are operations that are naturally expressed in C. Second, C and C++ are widely used languages, so learning them is a useful thing to do in its own right. You have some experience in C from CS201, and you will need to build on that here.</p>
<p>If you are interested in why C looks like it does, we encourage you to look at Ritchie's <a href="https://www.bell-labs.com/usr/dmr/www/chist.html">history</a>. Here, perhaps, is the key quotation: "Despite some aspects mysterious to the beginner and occasionally even to the adept, C remains a simple and small language, translatable with simple and small compilers. Its types and operations are well-grounded in those provided by real machines, and for people used to how computers work, learning the idioms for generating time- and space-efficient programs is not difficult. At the same time the language is sufficiently abstracted from machine details that program portability can be achieved."</p>
<p>You will do short exercises in C, as a warmup, and to help review some of what you learned in CS201 about C. Enter the devbox (<code>vagrant ssh</code>, per the <a href="../setup.html">setup page</a>) and then:</p>
<pre><code>$ cd cs202/lab1/mini</code></pre>
<p>(Depending on your CS201 section, you may have seen very similar, or the same, exercises; that’s fine. If you’re not absolutely fluent in C programming, then doing them again will be useful.)</p>
<div class="required">
<p><span class="header">Exercise 1.</span> Implement the functions in <code>part1.c</code></p>
</div>
<p>For Exercises 1 through 3, you can test with:</p>
<pre><code>$ make
$ build/part1</code></pre>
<p>You should have seen <code>make</code> in CSO. Recall that it is an automatic way to build software. In this case, it invokes the compiler and links your compiled code to a small test harness that we provide.</p>
<pre><code>$ ./build/part1
part1: set_to_fifteen OK
part1: array_sum OK</code></pre>
<p>If your part1.c is correctly implemented, you will see OK, as above.</p>
<p>You will need to remove the <code>assert(0);</code> line. Remove this as you implement functions in future exercises; it is a reminder that you have yet to implement a particular function.</p>
<p>As you write your code and improve it (fixing bugs, adding functionality), you should get in the habit of syncing your changes to the master copy of your labs repository on GitHub, for example:</p>
<pre><code>$ git commit -am &#39;my solution for lab1 exercise1&#39;
Created commit 60d2135: my solution for lab1 exercise1
 1 files changed, 1 insertions(+), 0 deletions(-)
$ git push origin</code></pre>
<p>The <code>commit</code> keeps the history of changes to your code, and so allows you to revert to an older version if you find that a change causes a regression. The <code>push</code> serves to back up your code on GitHub’s servers, so you won’t lose work if your local working copy is corrupted or lost.</p>
<div class="required">
<p><span class="header">Exercise 2.</span> Implement the functions <code>set_point</code> and <code>point_dist</code> in <code>part2.c</code>.</p>
</div>
<p>As above, you compile and test with:</p>
<pre><code>$ make</code></pre>
<p>Now you should see</p>
<pre><code>$ ./build/part2
part2: set_point OK
part2: point_dist OK</code></pre>
<p>Note that you can keep track of your changes by using the <code>git diff</code> command. Running <code>git diff</code> will display the changes to your code since your last commit, and <code>git diff origin/main</code> will display the changes relative to the initial code supplied for this lab. Here, <code>origin/main</code> is the name of the git branch with the initial code you downloaded from our server for this assignment.</p>
<div class="required">
<p><span class="header">Exercise 3.</span> Implement the linked_list utility functions in <code>part3.c</code>.</p>
</div>
<p>Test it:</p>
<pre><code>$ make
$ ./build/part3
part3: list_insert OK
part3: list_end OK
part3: list_size OK
part3: list_find OK
part3: list_remove OK</code></pre>
<div class="highlight">
<p><span class="header">Debugging note</span>: if you are having trouble with this piece, you may wish to skip to the section covering gdb, below, and come back here. You would do:</p>
<pre><code>$ gdb build/part3 core
(gdb) bt</code></pre>
<p>(Make sure you’ve issued the <code>ulimit</code> command below.)</p>
</div>
<div class="highlight">
<p><span class="header">Another debugging note</span>: the <code>assert</code> lines we’ve been seeing are a simple application of a powerful tool. You may wish to use asserts yourself, to help debug your linked list functions.</p>
<p>In C, an <code>assert</code> is a <em>preprocessor macro</em> which effectively enforces a contract in the program. (You can read more about macros in C <a href="http://gcc.gnu.org/onlinedocs/cpp/Macros.html">here</a>.) The contract that <code>assert</code> enforces is simple: when program execution reaches <code>assert(&lt;condition&gt;)</code>, if <code>condition</code> is true, execution continues; otherwise, the program aborts with an error message.</p>
<p>Assertions, when used properly, are powerful because they allow the programmer who uses them to guarantee that certain assumptions about the code hold. For example, you will see assertions like:</p>
<pre><code>assert(head != NULL);</code></pre>
<p>This assertion enforces the contract that the parameter head cannot be <code>NULL</code>. If these assertions were not present and we tried to dereference <code>head</code>, for example with <code>*head</code>, we would encounter a type of error called a <em>segmentation violation</em> (or <em>segmentation fault</em>). This is because dereferencing the <code>NULL</code> address is invalid; <code>NULL</code> points to "nothing". Later in the lab, we will get some experience with segmentation faults.</p>
<p>But by using assertions, we guarantee that <code>list_end</code> (for example) will never try to dereference a <code>head</code> variable at <code>NULL</code>, saving us the headache of having to debug a segmentation fault if some code tried to pass us a <code>NULL</code> value. Instead, we will get a handy error message describing exactly what contract of the function was invalidated.</p>
<p>Use your own asserts to make debugging easier!</p>
</div>
<h3 id="advice-on-debugging-common-problems-encountered-in-doing-this-lab">Advice on debugging common problems encountered in doing this lab</h3>
<ul>
<li><p><strong>Remember to recompile changed code</strong> Whenever you’ve changed a file, always type <code>make</code> to re-compile before executing again.</p></li>
<li><p><strong>Write your own simple test code.</strong> Don’t rely solely on the lab’s testing infrastructure (i.e. ./grade-lab) to test the correctness of your code. We don’t distribute the source of the harness code; this makes it hard to debug. So you should write your own tester. Let’s say you want to test the <code>array_sum</code> function in the file <code>part1.c</code>. To write your own test code, create a file (e.g. called <code>test-part1.c</code>) with a <code>main</code> function that invokes <code>array_sum</code> in various ways to test its correctness.</p>
<p>An example <code>test-part1.c</code> might look something like <a href="test_part1.c">this</a>.</p>
<p>Compile your test code by typing:</p>
<pre><code>  $ gcc -pedantic -Wall -std=c11 -g -o test_part1 test_part1.c part1.c</code></pre></li>
<li><p><strong>Use <code>gdb</code></strong> As we noted above, and as will be covered below.</p></li>
</ul>
<h3 id="c-programs-from-scratch">C programs from scratch</h3>
<p>In the rest of Section 1 of the lab, you will get practice writing and compiling C programs from scratch. Knowing how to create a standalone C program is useful in its own right, and it will be helpful context for lab2.</p>
<p>We will quickly walk through how to write and compile a program in C, and then you will write and compile several programs of your own.</p>
<p>Using a text editor, create a file called <code>fun.c</code>. In this file, type:</p>
<pre><code>#include &lt;stdio.h&gt;

int main(int argc, char** argv)
{
    char* first_arg; 
    char* second_arg; 

    /* this checks the number of arguments passed in */
    if (argc != 3) {
        printf(&quot;usage: %s &lt;arg1&gt; &lt;arg2&gt;\n&quot;, argv[0]);
        return 0;
    }

    first_arg = argv[1];
    second_arg = argv[2];

    printf(&quot;My program was given two arguments: %s %s\n&quot;,
           first_arg, second_arg);

    return 0;

}</code></pre>
<p>This is a complete C program. The <code>#include</code> at the top tells the compiler to use the header files of "standard I/O" (the standard input/ouput functions of the C library; these functions include <code>printf</code>). Also, <code>argc</code> contains the number of arguments passed to the program (including the program name itself) while <code>argv[0]</code> contains the name of the program that was invoked.</p>
<p>You can compile this program using:</p>
<pre><code>$ gcc -pedantic -Wall -std=c11 -g -o fun fun.c</code></pre>
<p>You can now run this program using:</p>
<pre><code>$ ./fun</code></pre>
<p>You should see:</p>
<pre><code>usage: ./fun &lt;arg1&gt; &lt;arg2&gt;</code></pre>
<p>You can also do:</p>
<pre><code>$ ./fun abc def
My program was given two arguments: abc def</code></pre>
<p>Note the pattern here:</p>
<ul>
<li><p>you create a C file and compile it with</p>
<pre><code>$ gcc [flags] -o &lt;output-file-name&gt; &lt;input-file-name&gt;</code></pre></li>
<li><p>You run your program using whatever was after the <code>-o</code> flag.</p></li>
<li><p>Inside the program, you gain access to the arguments using the <code>argv</code> array. (As we’ll see in this semester, the OS syscall <code>exec()</code> takes an argv; the OS takes that array and passes it to the new program's <code>main()</code> function.)</p></li>
</ul>
<div class="required">
<p><span class="header">Exercise 4.</span> Write, from scratch, a C program that takes two arguments and prints the first three characters of each string. If either of the two arguments has fewer than three characters, print an error message, and end gracefully (as opposed to core dumping).</p>
<p>For example:</p>
<pre><code>$ ./first3 a b
./first3: error: one or more arguments have fewer than 3 characters

$ ./first3 abcd wxy
abcwxy</code></pre>
<p>Instructions:</p>
<ul>
<li><p>You may use the function <code>strlen()</code>. If you do, include <code>#include &lt;string.h&gt;</code> at the beginning of the program.</p></li>
<li><p>Put all your files in <code>~/cs202/lab1/fromscratch/first3</code>.</p></li>
<li><p>Your executable file must be named <code>first3</code>.</p></li>
<li><p>You must supply a Makefile. When we type <code>make</code>, it needs to create a binary executable named <code>first3</code>.</p></li>
<li><p>Be diligent about creating test cases for yourself. You will lose points for not handling corner cases. You may wish to create a script that runs and tests your code on various cases. (You do not have to hand in your testing code, however; we will run our own testing scripts against your code.)</p></li>
<li><p>Pay attention to coding style.</p></li>
<li><p>Remember to add relevant source files and the Makefile to your git repo. Type <code>git status</code>, and if any of the files look relevant, add and commit them:</p>
<pre><code>  $ git status
  $ git add *.c *.h Makefile
  $ git commit -am &quot;first3&quot;
  $ git push origin</code></pre></li>
</ul>
</div>
<div class="required">
<p><span class="header">Exercise 5.</span> Write, from scratch, a C program that takes a single argument and prints the number of ascii ‘a’ characters in the string. <strong>Don’t use the function <code>strlen()</code></strong>; programs using <code>strlen()</code> will get 0 points. The purpose of this exercise is in part to give you familiarity with so-called “null-terminated strings” in C. A null-terminated string is a pointer to an array of characters (<code>char *</code>), in which the end of the string is indicated by the character ‘\0’, which has value 0, or <code>NULL</code>.</p>
<p>For example:</p>
<pre><code>$ ./countas abbba
2

$ ./countas aaaaa
5

$ ./countas bcdefghwxyz
0

$ ./countas
usage: countas &lt;arg&gt;

$ ./countas aaaaa bbbbbb
usage: countas &lt;arg&gt;</code></pre>
<p>Instructions:</p>
<ul>
<li>Again, don’t use <code>strlen()</code>.</li>
<li>Put all your files in <code>~/cs202/lab1/fromscratch/countas</code>.</li>
<li>Your executable file must be named <code>countas</code>.</li>
<li>If <code>countas</code> receives any number of arguments other than 1, it should print a help/usage message (see above).</li>
<li>You must supply a Makefile. When we type <code>make</code>, it needs to create a binary executable named <code>countas</code>.</li>
<li>Be diligent about creating test cases for yourself. You will lose points for not handling corner cases. You may wish to create a script that runs and tests your code on various cases. (You do not have to hand in your testing code, however; we will run our own testing scripts against your code.)</li>
<li>Pay attention to coding style.</li>
<li>As above, remember to add relevant files (source file, Makefile) to your git repo: <code>git status ; git add [...] ; git commit -am "countas" ; git push origin</code>.</li>
</ul>
</div>
<h2 id="section-2-debugging">Section 2: Debugging</h2>
<p>This part of the lab will give you practice debugging.</p>
<p>Put your answers for this section and in the next in the supplied <code>answers.txt</code> file.</p>
<h3 id="navigating-to-syntax-errors">Navigating to syntax errors</h3>
<p>Go to the <code>dbg</code> directory in <code>lab1</code>:</p>
<pre><code>$ cd ~/cs202/lab1/dbg</code></pre>
<p>Now type:</p>
<pre><code>$ make</code></pre>
<p>The code has a syntax error; thus, it cannot be compiled.</p>
<div class="required">
<p><span class="header">Exercise 6.</span> Fix the syntax error.</p>
<p>Use the compiler's error message to determine what's wrong. Note that in the <code>vi</code> text editor (discussed below) you can navigate to a given line of code <code>:&lt;number&gt;</code>. You can also <em>launch</em> <code>vi</code> with its cursor in place:</p>
<pre><code>$ vi +&lt;number&gt; &lt;filename&gt;</code></pre>
<p>to begin directly on a given line number. For example, <code>vi +5 foo.c</code> begins with the cursor at line 5.</p>
</div>
<p>After you fix the syntax error, the code will compile. Use <code>make</code> to see this:</p>
<pre><code>$ make</code></pre>
<p>Now, try testing the code itself, using the small <code>test_linked_list</code> utility:</p>
<pre><code>$ ./test_linked_list
Segmentation fault (core dumped)</code></pre>
<p>Aha! Our code compiled, but it was not correct (core dumps are bad). Specifically, the segmentation fault means that our program issued an illegal memory reference, and the operating system ended our process. Making matters worse, we have no idea what the problem in the code is. In the following section, you will learn how to use <code>gdb</code> to debug this kind of problem.</p>
<p><strong>Run gdb:</strong> Use the GNU debugger, or <code>gdb</code> to run the program:</p>
<pre><code>$ gdb test_linked_list
(gdb)</code></pre>
<p><strong>Set breakpoints:</strong> One thing that you might want to do is to set a <em>breakpoint</em> before the program begins executing. Breakpoints are a way of telling <code>gdb</code> that you want it to execute your program and then stop, or <em>break</em>, at a place that you define. Use the following command to set a breakpoint at the <code>main</code> function:</p>
<pre><code>(gdb) b main
Breakpoint 1 at 0x400963: file test_linked_list.c, line 43.</code></pre>
<p>Then use gdb's command <code>run</code> to actually start the program (this is the general pattern in gdb: one invokes the debugger, perhaps sets a breakpoint, and then starts the program with <code>run</code>):</p>
<pre><code>(gdb) run</code></pre>
<p>The program will be stopped when it reaches the breakpoint (advanced topic: how does gdb conspire with the hardware to make this work??). At this point, you will be presented with gdb's command prompt again. To see the “call stack” (or <i>stack trace</i>), which is the list of functions that have called this one – literally, the stack frames on top of the current one – you issue <code>backtrace</code> or <code>bt</code> for short:</p>
<pre><code>(gdb) bt</code></pre>
<p>Experienced developers will often ask for a stack trace as step 0 or 1 of understanding a code problem. Get in the habit of asking <code>gdb</code> to give you a backtrace.</p>
<p>To make the program continue running after a breakpoint, use <code>continue</code>, or <code>c</code> for short:</p>
<pre><code>(gdb) c</code></pre>
<p><strong>Step through the code:</strong> Of course, if you just <code>c</code> every time you hit a breakpoint, then you will lose control of the program. You often want the command <code>next</code>, or <code>n</code>:</p>
<pre><code>(gdb) n</code></pre>
<p>This "executes" the next line of code, for example executing an entire function. (The command <code>step</code> executes a single line of C code. There is little difference between <code>step</code> and <code>next</code> unless you are about to enter a function. <code>step</code> steps into the function; <code>next</code> "steps over" the function.)</p>
<p><span id="checkVariable"><strong>Inspect the values of variables:</strong></span> In gdb's command prompt, the program is stalled. You can query the program's current global and local variables with the <code>print</code> command, or <code>p</code> for short.</p>
<div class="required">
<p>Run <code>gdb</code> on <code>test_linked_list</code>. Set a breakpoint at the function <code>list_delete</code>.</p>
</div>
<p>At this breakpoint, determine the value of the integer <code>id</code>:</p>
<pre><code>(gdb) print id
$1 = 1</code></pre>
<p>This means that variable <code>id</code> holds the integer 1.</p>
<p>Aside: you can check local variables' names using:</p>
<pre><code>(gdb) info local</code></pre>
<p><strong>Core dump:</strong> If a program terminated abnormally (for example, <code>test_linked_list</code>), the state of the program will be recorded by the OS and (if core dumps are enabled) saved in a so-called core dump. <code>gdb</code> can use a core dump to inspect a crash situation.</p>
<p>To debug using core dumps, you must first enable core dumps, and then point gdb at the relevant file. We'll do this in several steps:</p>
<pre><code># enable core dumps
$ ulimit -c unlimited 
$ ./test_linked_list
$ ls -l core
$ gdb ./test_linked_list core</code></pre>
<p>The idea here is that the core file gives <code>gdb</code> enough information to recover the memory and CPU state of the program at the moment of the crash. This will allow you to determine which instructions experienced the error.</p>
<div class="required">
<p><span class="header">Exercise 7.</span> Fix the bug in the code. Recompile and rerun to make sure it is fixed. State the line of code and the fix in <code>answers.txt</code>.</p>
</div>
<h2 id="section-3-software-development-skills-and-general-productivity">Section 3: Software development skills and general productivity</h2>
<p>This part of the lab will walk through general software development skills as well as some tools to enhance your productivity. You may feel at first that these tools are slowing you down ("how do I enter characters in vi???"), but comfort and fluency with them will pay off in the long term. It's worth slowing down and "learning proper technique."</p>
<h3 id="a-good-text-editor-is-essential">A good text editor is essential</h3>
<div class="required">
<p>If you are not doing so already, begin using a powerful text editor. We recommend <code>vi</code> (which in our development environment is an alias for a more powerful version, called <code>vim</code>) or <code>emacs</code>. <code>vim</code> is already installed on the devbox. If you want to install emacs, do: <code>sudo apt-get install -y emacs</code>.</p>
<p>Then, to edit:</p>
<pre><code>$ vi myfile.txt </code></pre>
<p>or</p>
<pre><code>$ emacs myfile.txt</code></pre>
<p>Most of our instructions below will be with reference to vi, so you may wish to use that one.</p>
<p>To get started, work through either <a href="http://wiki.gentoo.org/wiki/Vim/Learning">this vi tutorial</a> or the emacs tutorial that is built into emacs. (From within emacs, you can pull up the tutorial by typing <code>C-h t</code>. This is read as "press ctrl-h, then let go, then press t").</p>
<p>Then spend some time just navigating and editing sample text (perhaps doing this lab, perhaps writing notes to your friends that you later copy into email). You'll find that within a day or so, you'll have the required keystrokes internalized, and within a few days, you'll probably be faster at common editing tasks.</p>
<p>If you’re already using a good editor on your desktop (such as Sublime Text), then you’ll want to set it up to edit files remotely over ssh; see the <code>vagrant ssh-config</code> command on the <a href="../setup.html">setup page</a>.</p>
</div>
<h3 id="navigating-code-ctags">Navigating code: <code>ctags</code></h3>
<p>We will investigate <code>ctags</code> with the Linux code base as a running example.</p>
<p>Create a new directory (<em>not</em> inside cs202, since we don't need the Linux code to be part of your later submission):</p>
<pre><code>$ mkdir ~/learn-ctags
$ cd ~/learn-ctags</code></pre>
<p>Now download and unpack the Linux source code archive. We are interested in the kernel source and header files:</p>
<pre><code>$ wget https://cdn.kernel.org/pub/linux/kernel/v5.x/linux-5.2.9.tar.xz
# the line above will take a few minutes
$ tar -xf linux-5.2.9.tar.xz linux-5.2.9/include linux-5.2.9/kernel
$ cd linux-5.2.9
$ ls 
include/ kernel/</code></pre>
<p>Now, you are going to use the <em>ctags</em> program. Type:</p>
<pre><code>$ ctags --recurse=yes * 
# this could take time</code></pre>
<p>The <code>ctags</code> utility searches a body of code and creates a <em>tag file</em>, which is an index of programming language objects, such as function and variable definitions. The command above invokes <code>ctags</code> recursively on all items in the entire directory (<code>*</code>) in order to create a single tags file that includes information from all files in the repository.</p>
<p>The rest of this section will use <code>vi</code> to interact with tags. However, <code>emacs</code> also supports tags.</p>
<p>Using <code>vi</code>, open the header file for the linux scheduler:</p>
<pre><code>$ vi include/linux/sched.h</code></pre>
<p>We will now walk through some uses of tags. When we type <code>:something</code>, this refers to a command given in vi's <em>command mode</em>. To get into command mode in vi, you type the escape key (vi by default starts in command mode; the editor enters <em>insert mode</em> when you type i, e, a, etc.). Once in command mode, typing <code>:something</code> does the "something". (For example, try pressing escape and then <code>:q</code>.)</p>
<p>Now, let's get started with tags. Type:</p>
<pre><code>:tag sched_attr</code></pre>
<p>This will take you to the definition of <code>sched_attr</code>. To return to your previous position, press <code>ctrl-t</code>.</p>
<p>The tag file that we created indexed all of Linux's source. We can jump to a tag in another file and it will automatically be opened, as we illustrate in the following exercise.</p>
<div class="required">
<p><span class="header">Exercise 8.</span> Type within vi:</p>
<pre><code>:tag block_device_operations</code></pre>
<p>What file does this open? (You can use the command <code>:ls</code> inside of vi to check this.) Put the answer in <code>answers.txt</code>.</p>
</div>
<p>You can use <code>ctrl-]</code> to jump to the definition of the object underneath the cursor. Go to line 1001 in <code>include/linux/sched.h</code> (navigate there with <code>:1001</code>, since <code>:&lt;number&gt;</code> in vi takes you to the specified line number). Move your cursor over the token <code>futex_pi_state</code>. Press <code>ctrl+]</code>.</p>
<div class="required">
<p><span class="header">Exercise 9.</span> What is <code>futex_pi_state</code>? In what file and line is it defined?</p>
</div>
<p>A tag may have multiple definitions. type:</p>
<pre><code>:tselect list_head</code></pre>
<p>and note that a menu pops up giving you the choice of which definition to view.</p>
<p>Tags can also be used with regular expressions. For example, to look up all tags containing <code>proc_sched</code>, enter the following:</p>
<pre><code>:tselect /proc_sched</code></pre>
<p>And the following command shows tags that contain <code>proc_sched</code> and <code>task</code> (in that order):</p>
<pre><code>:tselect /proc_sched.*task</code></pre>
<div class="required">
<p><span class="header">Exercise 10.</span> How many functions does the linux kernel have that contain <code>proc_sched</code> and <code>task</code>? Where are they defined?</p>
</div>
<p>For more information about tags, <a href="http://vim.wikia.com/wiki/Browsing_programs_with_tags">this resource</a> is good.</p>
<h3 id="general-productivity-find">General productivity: <code>find</code></h3>
<p>We now cover a very powerful Unix tool: <code>find</code>.</p>
<p>At a high level, find by default recurses through directories, "looking" at files, to see which files match a provided predicate. Here is the pattern for its use:</p>
<pre><code>$ find [flags] [path...] [expression]</code></pre>
<p>Now <code>cd</code> to the root directory of the linux kernel that you downloaded earlier. Type this command:</p>
<pre><code>$ find .
.
./kernel
./kernel/panic.c
./kernel/Kconfig.locks
./kernel/params.c
./kernel/.gitignore
./kernel/memremap.c
./kernel/freezer.c
./kernel/sysctl_binary.c
.....</code></pre>
<p>This recursively prints all files in the current directory (it will print the names of tens of thousands of files).</p>
<p>You can also search on file name patterns:</p>
<pre><code>$ find . -name &quot;sched.h&quot;
./kernel/sched/sched.h
./include/uapi/linux/sched.h
./include/linux/sched.h
./include/linux/sunrpc/sched.h
./include/asm-generic/bitops/sched.h
./include/xen/interface/sched.h
./include/trace/events/sched.h</code></pre>
<p>And you can limit the search to particular directories:</p>
<pre><code>$ find include/linux include/asm-generic -name &quot;sched.h&quot;
include/linux/sched.h
include/linux/sunrpc/sched.h
include/asm-generic/bitops/sched.h</code></pre>
<p>As with most Unix commands, wildcards can be used:</p>
<pre><code>$ find . -name &quot;sched.*&quot;
./kernel/sched/sched.h
./include/uapi/linux/sched.h
./include/linux/sched.h
./include/linux/sunrpc/sched.h
./include/asm-generic/bitops/sched.h
./include/xen/interface/sched.h
./include/trace/events/sched.h</code></pre>
<p>This returns all files named "sched" with any extension.</p>
<p>Where find really starts to be powerful is that you can execute commands on the files that are returned. For example:</p>
<pre><code>$ find . -name &quot;sched.h&quot; -exec grep foobar {} \;</code></pre>
<p>This says, "return all file names that match sched.h and grep each of them for the string foobar."</p>
<div class="required">
<p><span class="header">Exercise 11.</span> How many header files are there in the linux source code?</p>
<p>Hint: The unix program <code>wc</code> can be used to count words or lines from a file or standard input. How can we get the output from <code>find</code> to <code>wc</code>?</p>
</div>
<p>More information on <code>find</code> can be found <a href="http://www.binarytides.com/linux-find-command-examples/">here</a>.</p>
<p>We will cover other tools (such as <code>grep</code>) as the semester goes on.</p>
<h2 id="handin-procedure">Handin Procedure</h2>
<p>Handing in consists of three steps:</p>
<ol type="1">
<li><p><strong>Executing this checklist</strong>:</p>
<ul>
<li>Fill out the top of the <code>answers.txt</code> file, including your name and NYU Id</li>
<li>Make sure you’ve answered every question in <code>answers.txt</code></li>
<li>Create a file called <code>slack.txt</code> noting how many slack days you have used for this assignment. (This is to help us agree on the number that you have used.) Include this file even if you didn’t use any slack days.</li>
</ul></li>
<li><p><strong>Push your code to GitHub, so we have it</strong>:</p>
<pre><code>$ cd ~/cs202/lab1     
$ git commit -am &quot;hand in lab1&quot;
$ git push origin 

Counting objects: ...
....
To ssh://github.com/nyu-cs202/labs-21fa-&lt;username&gt;.git
  7337116..ceed758  main -&gt; main</code></pre></li>
<li><p><strong>Actually submit, by timestamping and identifying your pushed code</strong>:</p>
<ul>
<li>Decide which git commit you want us to grade, and copy its id (you will paste it in the next sub-step). A <a href="http://cs61.seas.harvard.edu/wiki/2014/Git#Repositories">commit id is a 40-character hexadecimal string</a>. Usually the commit id that you want will be the one that you created last. The easiest way to obtain the commit id for the last commit is by running the command <code>git log -1 --format=oneline</code>. This prints both the commit id and the initial line of the commit message. If you want to submit a previous commit, there are multiple ways to get the commit id for an earlier commit. One way is to use the tool <code>gitk</code>. Another is <code>git log -p</code>, as explained <a href="http://cs61.seas.harvard.edu/wiki/2014/Git#Logging">here</a>, or <code>git show</code>.</li>
<li>Now go to NYU Brightspace; there will be an entry for this lab. Paste <em>only</em> the commit id that you just copied.</li>
<li>You can submit as many times as you want; we will grade the last commit id submitted to Brightspace.</li>
</ul></li>
</ol>
<p><strong>NOTE:</strong> <em>Ground truth is what and when you submitted to Brightspace. Thus, a non-existent commit id in Brightspace means that you have not submitted the lab, <strong>regardless</strong> of what you have pushed to GitHub. And, the time of your submission for the purposes of tracking lateness is the time when you upload the id to Brightspace, not the time when you executed <code>git commit</code>.</em></p>
<p><strong>This completes the lab.</strong></p>
</body>
</html>
